<!--
/*
*******************************************************************************
* Copyright (C) 2006-2008, International Business Machines Corporation and    *
* others. All Rights Reserved.                                                *
*******************************************************************************
* This is the ant build file for ICU tools. 
*/
-->
<project name="release-tools" default="tools" basedir=".">
    <target name="init">
        <tstamp/>
        <property name="src.dir" value="src"/>
        <property name="build.dir" value="classes"/>
        <property file="api-report.properties" />

        <mkdir dir="${build.dir}"/>
        <echo message="java home: ${java.home}"/>
        <echo message="java version: ${java.version}"/>
        <echo message="java vendor: ${java.vm.vendor}"/>
        <echo message="ant java version: ${ant.java.version}"/>
        <echo message="${ant.version}"/>
        <echo message="${basedir}"/>

        <condition property="is.sun.jdk14">
            <and>
                <equals arg1="${ant.java.version}" arg2="1.4"/>
                <!--<contains string="${java.vm.vendor}" substring="Sun Microsystems Inc"/> -->
            </and>
        </condition>
        <fail unless="is.sun.jdk14" message="Sun JDK1.4 is required."/>
    </target>

    <target name="tools"  depends="init" description="compile release tools">
        <javac includes="**/*.java"
            srcdir="${src.dir}"
            destdir="${build.dir}"
            source="1.4"
            debug="on" deprecation="off"
            encoding="ascii"/>
    </target>             

    <target name="clean" depends="init" description="remove all build targets">
        <delete dir="${build.dir}"/>
    </target>

    <target name="apireport" depends="tools">    
        <java classname="com.ibm.icu.dev.tools.docs.StableAPI" fork="yes" failonerror="true">
            
<!--
	!! Only need these if you must override. Remove the DELETEME
            <arg value = "-DELETEME-oldver"/>
            <arg value = "${oldver}"/>
-->
            
            <arg value = "--olddir"/> 
            <arg value = "${olddir}"/>
            
<!--
	!! Only need these if you must override. Remove the DELETEME
            <arg value = "-DELETEME-newver"/>
            <arg value = "${newver}"/>
-->
            
            <arg value = "--newdir"/>
            <arg value = "${newdir}"/>
            
            <arg value = "--cppxslt"/>
            <arg value = "${basedir}/src/com/ibm/icu/dev/tools/docs/dumpAllCppFunc.xslt"/>
            
            <arg value = "--cxslt"/>
            <arg value = "${basedir}/src/com/ibm/icu/dev/tools/docs/dumpAllCFunc.xslt"/>
            
            <arg value = "--reportxslt"/>
            <arg value = "${basedir}/src/com/ibm/icu/dev/tools/docs/genReport.xslt"/>
            
            <arg value = "--resultfile"/>
            <arg value = "${basedir}/APIChangeReport.html"/>

            <classpath>
                <pathelement location="${build.dir}"/>
                <pathelement path="${java.class.path}/"/>
                <pathelement path="."/>
            </classpath>
        </java>
    </target>
</project>
